library(WGCNA)
library(fastLiquidAssociation)
library(Hmisc)
allowWGCNAThreads()
eset<-read.table("transfA.txt", header=T, sep="\t")
row.names(eset) <-eset[,1]
eset <-eset[,-1]
data<-t(eset)
data <- data[,1:822]
result <- fastMLA(data=data,topn=30000,nvec=721:822,rvalue=0.5,cut= 5)
CNMcalc <- mass.CNM(data=data, GLA.mat=result, nback= 20000)
finalres<-CNMcalc$"top p-values"
write.csv(finalres,file="resfastLA10.csv")
boot <- CNMcalc$"bootstrap triplets"
write.csv(boot,file=" boot10.csv")
clust <- makeCluster(4)
GLAeasy <- fastboots.GLA(boot, data=data, clust=clust, boots=30, perm=100)
stopCluster(clust)
closeAllConnections()
write.csv(GLAeasy,file=" resfasLAboot.csv")
